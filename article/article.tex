\chapter{A point-level trend model for the North American Breeding Bird Survey that corrects for detectability}
	
\section{Introduction}
\par Data for the North American Breeding Bird Survey (BBS) have been collected since the 1960s when the BBS first started \citep{hudson_role_2017, sauer_first_2017}. 
The protocol has remained essentially the same since. 
Each year, observers run their BBS ``route", which consists of 50, 3-minute point counts spaced roughly 800 m apart from each other. 
The observer is instructed to record every bird they see or hear within a 400 m radius of each point, during each of the 3-minute point counts. 
Counts for each species x route combination are summed.
These data are then modelled as follows:

\begin{equation*}
	Y_{J,i,t,o} | \alpha_i, \delta_{i,t}, \gamma_{i,t}, \psi_J, \omega_o, \eta \sim NegBin(\lambda_{J,i,t,o}, \nu)
\end{equation*}
\begin{equation}\label{bbs}
\log(\lambda_{J,i,t,o}) = \alpha_i + \delta_{i,t} + \gamma_{i,t} + \psi_J + \omega_o + \eta I(o,J,t) + \epsilon_{J,i,t,o}.
\end{equation}

Counts $Y$ for each route $J$ in stratum $i$, in year $t$ observed by observer $o$ are modelled as realizations of a negative binomial distribution with mean $\lambda_{J,i,t,o}$ and inverse dispersion parameter $\nu$ \citet{smith_spatially_2023}. 
Note that we have explicitly chosen to use capital letter $J$ to represent the route, as this will be differentiated from specific points $j$ within a route $J$ later in this paper.
On the log scale, values of $\lambda$ are modelled by intercepts representing mean count for each stratum ($\alpha_i$), route($\psi_J$), and observer ($\omega_o$), plus a temporal component $\delta_{i,t}$ that estimates population trajectory through time. 
Since the temporal component is a smoothed GAM \citep{smith_north_2021}, we also add in an annual fluctuation term $\gamma_{i,t}$ to allow for fluctuations from the smooth. 
We also have a first-year observer term $\eta$ that is present if the route $J$ in year $t$ is run by observer $o$ for the first time, and is zero otherwise. 
Finally, we also have a random noise term $\epsilon_{J,i,t,o}$.
See \citet{smith_north_2021} and \citet{smith_spatially_2023} for discussions on prior selection for this model.

\par To estimate annual population indices, we use the population index calculation used in \citet{smith_north_2021} to calculate indices of abundance at a stratified level:

\begin{equation}\label{index}
	n_{i,t} = \dfrac{\sum_{J\in S_i}\exp(\alpha_i + \psi_J + \delta_{i,t})}{|S_i|}
\end{equation}

That is, the index of abundance $n$ at stratum $i$ in year $t$ will be the exponentiated sum of the stratum effects $\alpha_i$, route effect $\psi_J$, and year effect $\delta_{i,t}$ for each route in stratum $S_i$, averaged over the number of routes in stratum $S_i$.
As such, each index represents the expected count on an average BBS route conducted by an average observer in a given year \citep{smith_north_2021}.
These indices are then used to calculate trend $T$ from year $t_a$ to year $t_b$ as

\begin{equation*}
	T_{a:b} = 100 \times \left( \left( \dfrac{N_{t_a}}{N_{t_b}} ^ {\dfrac{1}{t_a - t_b}} \right) - 1 \right)
\end{equation*}

where $N_t$ is the index of abundance in given year and stratum.
These trends have been used as the gold standard of trend estimates for North American bird populations for decades, and have informed numerous important reports such as the State of Canada's Birds \citep{north_american_bird_conservation_initiative_canada_state_2019} and State of North American Birds \citep{north_american_bird_conservation_initiative_canada_state_2022}, and have been used to estimate the overall loss of close to three billion birds since the 1970s \citep{rosenberg_decline_2019}. 

Given the recent detectability offsets generated by the NA-POPS project \citep{edwards_point_2023}, it would be useful to be able to incorporate these detectability offsets into the current BBS status and trends model. 
Incorporating these offsets can serve several purposes, from correcting for roadside and landcover biases via statistical offsets \citep{thogmartin_sensitivity_2010, solymos_lessons_2020, edwards_point_2023}, to integrating disparate data sources \citep{solymos_calibrating_2013, edwards_point_2023}. 
However, because the current BBS model considers summed counts at the route level (rather than at the individual point level), we cannot yet directly apply these offsets to BBS data. 

\par In this paper, we describe an extension of the current BBS status and trend model (i.e., Equation \ref{bbs}) that considers BBS data at the point-level. 
Using point-level (also called stop-level) data, we compare trends and trajectories of Ovenbird (\textit{Seiurus aurocapilla}) obtained through this point-level model to trends and trajectories obtained through the current route-level BBS models described in \citet{smith_spatially_2023}.
After establishing this baseline comparison, we incorporate detectability offsets into the new point-level model in two ways: first using a naive approach that considers these detectability offsets as true point values, and secondly by incorporating error associated with the derived detectability offsets and propagating forward the uncertainty using methods described in \citet{bravington_variance_2021}.
Finally, we investigate how incorporating detectability as offsets in both of these ways affects the trends and trajectories for Ovenbird across Canada, and in particular focus on areas where there has been large landcover changes.

\section{Methods}

\par The following subsections describe how the current route-level description of the model can be converted to a point-level model, by taking advantage of the stop-level data provided by the United States Geological Survey and Canadian Wildlife Service. 
We then expand this point-level model to explicitly include detectability estimates, as well as uncertainty around those estimates. 
Finally, we demonstrate the point-level model and the detectability model by modelling counts of Ovenbird in Canada from 2010 - 2022, and compare trends and trajectories from these models to trends and trajectories obtained from the route-level model in \citet{smith_spatially_2023}.

\subsection{Models}

\subsubsection{A Point-level Model for Modelling BBS Data}

\par Recall that the model described in Equation \ref{bbs} sums all points within a route $J$ and models these summed counts for each route $J$, such that the term $\psi_J$ is the route-level random effect and $\log(\lambda_{j,i,t,o})$ represents the mean expected count at route $J$ in stratum $i$ during year $t$ by observer $o$.
Rather than modelling at the route-level $J$, we can consider each individual point or ``stop" within a route as an independent count.
We would then be modelling at the point-level $j$.
The term $\psi_j$ would now represent a point-level random effect, and $\log(\lambda_{j,i,t,o})$ would represent the mean expected count at point $j$ in stratum $i$ during year $t$ by observer $o$. 
Our point-level model becomes

\begin{equation*}
	Y_{j,i,t,o} | \alpha_i, \delta_{i,t}, \gamma_{i,t}, \psi_j, \omega_o, \eta \sim NegBin(\lambda_{j,i,t,o}, \nu)
\end{equation*}
\begin{equation}\label{bbs-point}
	\log(\lambda_{j,i,t,o}) = \alpha_i + \delta_{i,t} + \gamma_{i,t} + \psi_j + \omega_o + \eta I(o,j,t) + \epsilon_{j,i,t,o}.
\end{equation}

Since we are modelling in a Bayesian context, we assign priors to each of the parameters. 
For the purposes of this study, we refer readers to the priors used in \citet{smith_north_2021} and \citet{smith_spatially_2023}.
We are using the spatially-explicit version of the model described in \citet{smith_spatially_2023}, which treats the spatial component of the model $\alpha_i$ as an intrinsic conditional auto-regressive (ICAR) model \citep{besag_bayesian_1991}.

\par Equation \ref{bbs-point} is nearly identical to the original route model outlined in Equation \ref{bbs}, except that we are considering point $j$ rather than route $J$.
Additionally, the index of abundance calculation described in Equation \ref{index} would also remain nearly identical, except that the summation term would be summing over all points $j$ in stratum $S_i$, rather than all routes $J$ in stratum $S_i$. 
That is, each $n_{i,t}$ would represent the expected count on an average BBS point conducted by an average observer in a given year.
We also point out that for this particular model, we are assuming that each point-level random effect $\psi_j$ is an independent realization of a Student's t-distribution, similar to realizations for each route-level random effect $\psi_J$ in \citet{smith_north_2021, smith_spatially_2023}.
However, we could have also chosen to model each point-level random effect in a multi-level model with route-level hyperparameters, if we wanted to share information between points within routes.

\subsubsection{A Point-level Model that Explicitly Includes Detectability}

\par Equation \ref{bbs-point} gives us the ability to model specifically at the point-count level, which provides us the opportunity to incorporate point-specific effects such as detectability.
Changes in detectability will affect how many birds are counted during a given point count, relative to the total number of birds are actually present at the site. 
Here, we will incorporate detectability as an offset, such that each count is adjusted based on the duration of the survey, maximum point-count radius, and combinations of survey start time and survey time of year (which affect probability of availability $p$), as well as roadside effects and forest coverage (which affect perception probability $q$). 
Thus, the specific offset at point $j$, year $t$, in stratum $i$ would be given by $\log(p q)_{j,i,t}$, and our model becomes:


\begin{equation*}
	Y_{j,i,t,o} | \alpha_i, \delta_{i,t}, \gamma_{i,t}, \psi_j, \omega_o, \eta \sim NegBin \left( \dfrac{\lambda_{j,i,t,o}}{p_{j,i,t}q_{j,i,t}}, \nu \right)
\end{equation*}
\begin{equation}\label{bbs-detect}
	\log(\lambda_{j,i,t,o}) = \log(p_{j,i,t}q_{j,i,t}) + \alpha_i + \delta_{i,t} + \gamma_{i,t} + \psi_j + \omega_o + \eta I(o,j,t) + \epsilon_{j,i,t,o}.
\end{equation}

\par When calculating the index of abundance, we could calculate the index at each point given the specific detectability conditions at that point in time.
In that case, we would include the term $\log(p_{j,i,t}q_{j,i,t})$ in the exponent of Equation \ref{index}.
Alternatively, we could calculate the index of abundance under perfect detection: if we set $p = q = 1$, then $\log(p_{j,i,t}q_{j,i,t}) = \log(1) = 0$, and our original index of abundance calculation given by Equation \ref{index} holds as normal.
For the remainder of this paper, when we calculate index of abundance from a model that incorporates detectability (i.e., either this model or the following model that propagates error) we will calculate index of abundance under perfect detection, such that the index of abundance represents the mean expected count at point $j$ in stratum $i$ during year $t$ by observer $o$, \textit{given perfect detectability}.

\subsubsection{A Point-level Model that Includes Detectability and Propagates Error}\label{varprop-text}

\par Because we are using estimated values of $p$ and $q$ (i.e., $\hat{p}$ and $\hat{q}$) from the NA-POPS database \citep{edwards_point_2023}, we must also have a way to propagate the uncertainty around these detectability estimates. \citet{bravington_variance_2021} gives us a method to propagate uncertainty for a detectability offset into a GAM model. Consider the general log offset term $\log(p q)$. Following \citet{bravington_variance_2021}, we can rewrite this offset term as follows:

\begin{equation}\label{offset}
	\log(pq) = log(\hat{p} \hat{q}) + \kappa^{(p)}\zeta + O(\zeta^2) + \kappa^{(q)}\xi + O(\xi^2).
\end{equation}
	 
\par Here, $log(\hat{p} \hat{q})$ is the log offset term with the estimated availability $\hat{p}$ and perceptibility $\hat{q}$ from NA-POPS. 
We also introduce two additional sets of terms: $\kappa^{(p)}\zeta + O(\zeta^2)$ and $\kappa^{(q)}\xi + O(\xi^2)$, which are the corresponding uncertainty propagation terms for availability and perceptibility, respectively.  
See Appendix A for full details of the derivation of these terms.
Our BBS model that includes detectability and variance propagation terms is then given by
\begin{equation}\label{bbs_varprop}
	\log(\lambda_{j,i,t}) = \log(\hat{p} \hat{q})_{j,i,t} + \kappa_{j,i,t}^{(p)}\zeta + \kappa_{j,i,t}^{(q)}\xi + \alpha_i + \delta_{i,t} + \gamma_{i,t} + \psi_j + \omega_o + \eta I(o,j,t) + \epsilon_{j,i,t,o} \\
\end{equation}

\subsection{Data Acquisition}

\subsubsection{Breeding Bird Survey Data}

\par We used the R package \texttt{bbsBayes2} to download and process BBS data \citep{edwards_bbsbayes_2021}. 
For analysis with the route-level model, we followed the same data preparation steps as normal, in that data were downloaded using \texttt{bbsBayes2}, stratified based on a 1-degree by 1-degree block of latitude and longitude, prepared for modelling in Stan \citep{stan_development_team_stan_2024}, and then modelled.
For point-level data, we accessed a database of known stop locations from the Canadian Wildlife Service BBS office, and matched these locations with each of the stops available from the stop-level data download from \texttt{bbsBayes2}.
Because we were only able to obtain known stop locations from Canadian Wildlife Service, our analysis is strictly limited to Canada.
%We note, however, a method for estimating known BBS locations given a BBS route shapefile (CITE), and so future analyses could take advantage of that.

\subsubsection{Landcover Data}

\par We downloaded the following data products from the North American Land Change Monitoring System: Land Cover, 2010 (Landsat, 30m); Landcover, 30m, 2015 (Landsat and RapidEye); and North American Land Cover, 2020 (Landsat, 30m).
Thus, we were able to obtain landcover at 30m resolution for the years 2010, 2015, and 2020. 
For each known BBS point, we created a 400 m radius buffer around the point (representing the maximum survey distance for each point), and calculated the proportion of forest coverage for 2010, 2015, and 2020. 
We used linear interpolation at each point to obtain forest coverage from 2011 - 2014 and from 2016 - 2019. 
Because we were interested in analyzing data up to and including the year 2022, we simply copied the forest coverage value in 2020 forward for the years 2021 and 2022, so as to make conservative assumptions about how the landcover might have changed in the last two years.

\par Because the BBS is inherently a roadside survey, we did not have to classify whether a point was a roadside survey or not.
Instead, we simply set all points to be roadside surveys for the purposes of estimating detectability.

\subsubsection{Detectability Data}

\par We used the R package \texttt{napops} \citep{edwards_napops_2024} to calculate the value of availability $\hat{p}$ and perceptibility $\hat{q}$ at each point.
To obtain availability, we needed to have the time at which a point was run, and the day of the year that it was run.
Day of the year was calculated as days since 1 January of that year.
Time of day was calculated as follows: given the start time and end time of a BBS route (which is available with the data download), we partitioned this duration of time into the number of points run for that particular route.
We note that normally the number of points run per route should be 50, but there is flexibility in what is considered a ``complete" route.
These partitioned times were then used as estimated start times for each of the points. 
Of course, there is uncertainty associated with these start times, but we chose to ignore it this time.
Availability was then obtained by inputting the vector of start times, day of the year, and survey durations (3 minutes per point) into the avail() function in \texttt{napops}.
Finally, to obtain perceptibility, we input the vector of forest coverage associated with each point, roadside status (which was TRUE for all points), and the maximum survey radius (400 m for BBS points) into the percept() function in \texttt{napops}.

\par The \texttt{napops} R package was also updated for this paper to include the ability to access the covariance matrix for the associated availability and perceptibility models, as well as the ability to calculate the value of first derivative of the detection functions evaluated at its maximmum likelihood estimate.
Both of these values are necessary for the variance propagation model (see Appendix A).

\subsection{Case Study: Ovenbird Trends and Trajectories in Canada, 2010 - 2022}

\par We applied the point-level BBS model (Equation \ref{bbs-point}), detectability BBS model (Equation \ref{bbs-detect}), and the variance propagation BBS model (Equation \ref{bbs_varprop}) to the Ovenbird BBS data to compare trend estimates obtained by these three models to trend estimates obtained via the current BBS route-level model described in \citet{smith_spatially_2023}.
Using the methods as described above, we first ran a route-level model for the years 2010 - 2022 to obtain indices and trends for Ovenbird as a baseline comparison.
Then, we obtained the landcover and detectability data for Ovenbird and ran the detectability model for the same years.
For Ovenbird, we used the ``best" models of availability and perceptibility as determined in \citet{edwards_point_2023}: the model that included Ordinal Day and its quadratic term was the best model for availability, and the model that included Roadside, Forest Coverage, and the interaction term was the best model for perceptibility.
Finally, we ran the variance propagation model for the same years as above.
These model runs resulted in four sets of indices and hence four time series.
We denote them as follows: ROUTE, for indices and trends from the route-level model (Equation \ref{bbs}); POINT, for indices and trends from the point-level model (Equation \ref{bbs-point}); DETECT, for indices and trends from the point-level model that includes detectability (Equation \ref{bbs-detect}); and VARPROP, for indices and trends from the point-level model that includes detectability and variance propagation (Equation \ref{bbs_varprop}).

\subsubsection{Comparing Indices and Trends from ROUTE versus POINT}\label{route-vs-point}

\par Before considering how detectability affects index and trend calculation from BBS data, we must first ensure that a point-level model does not significantly change the overall trends compared to the route model, and that the indices calculated from the point-level model vary predictively from the route-level model.
Put different, we want to ensure that the point-level model can serve as a reasonable proxy for the route-level model for later comparisons of detectability versus no detectability.

\par To assess how the POINT indices served as a proxy for ROUTE indices, we modelled each ROUTE index as a linear combination of its corresponding POINT index, for each route-year combination. 
That is:

$$	n_{{i,t}_{ROUTE}} \sim N(\alpha + \beta_i \times n_{{i,t}_{POINT}}, \sigma) $$
$$	\alpha \sim N(0,1) $$
$$	\beta \sim N(B, 1) $$
$$	B \sim N(50, 1) $$
$$	\sigma \sim exp(1)$$

If POINT indices are a reasonable proxy for ROUTE indices, then we would expect to see $\alpha \approx 0$ and $B \approx 50$; given there are 50 points per route, it is reasonable to assume that indices calculated at the route level should be approximately 50 times those calculated at the point level.

\par Similarly with trend, we modelled each ROUTE trend as a linear combination of its corresponding POINT trend, for each stratum.
That is:

$$ T_{ROUTE} \sim N(\alpha + \beta \times T_{POINT}, \sigma)$$
$$ \alpha \sim N(0,1) $$
$$ \beta \sim N(1,1) $$
$$ \sigma \sim exp(1) $$

If POINT trends are a reasonable proxy for ROUTE trends, then we would expect to see $\alpha \approx 0$ and $\beta \approx 1$, indicating a nearly 1-to-1 correspondence. 

\subsubsection{Variance Propagation Diagnostics}

\par \citet{bravington_variance_2021} gives a few relatively straightforward diagnostics to assess consistency between the detectability portion of the model and the abundance portion of the model, given the error propagation.
For this case study, we provide two diagnostics.
The first is to simply compare the indices and trends obtained from the VARPROP model to those obtained from the DETECT model to ensure that there are not large differences, particularly in space. 
We can assess this similar to subsection \ref{route-vs-point} where we simply model the VARPROP indices and trends as functions of the DETECT indices and trends.
Second, we assess the posterior distribution of the variance propagation parameters $\zeta$ and $\xi$.
A posterior distribution that centres reasonably close to 0 implies that there is no systematic bias in the detectability functions that contribute to the pattern of observations, and hence the detectability functions do not need ``correction".

\subsubsection{Comparing Indices and Trends from POINT versus VARPROP and DETECT}

\par We are interested to see how the incorporation of detectability affects index and trend estimates of Ovenbird.
In particular, we are interested in seeing if including detectability in the BBS trend model can possibly correct for systematic biases that may be present due to changing forest coverage.
%For example, consider a BBS point that has undergone signficant forest coverage change over the last decade (Figure TO DO).
%At the beginning of the decade, suppose this point was heavily forested, and was territory for eight Ovenbirds. 
%Because detectability in forested areas is generally lower than open areas due to sound attenuation \citep{yip_sound_2017}, we might expect an average observer to only detect, say, 30\% of these eight Ovenbirds, given they give a cue (i.e., sing) during the 3-minute point count.
%If, a decade later, this point has the same number of Ovenbirds but with much less forest coverage, we might expect an average observer to detect a higher percentage of Ovenbirds (say, 80\%), because the Ovenbird song would attenuate less over the more open environment.
%Without accounting for detectability, this may appear to be a population increase, whereas in reality the population has actually remained steady.
For this comparison, we focused on trend estimates for a route that experience a particularly high change in forest coverage, such that the forest coverage at the beginning of the time series was significantly higher than the forest coverage at the end of the time series.
Then, we compared trends and trajectories from the POINT model to those from the DETECT and VARPROP model, to assess if there was any differences given the changes in forest coverage.

\subsection{Analysis}
\par All analyses were conducted in R version 4.3.1 \citep{r_core_team_r_2024}.
All Bayesian models were coded in the Stan Probabilistic Language \citep{stan_development_team_stan_2024} and run using the \texttt{cmdstanr} R package \citep{gabry_cmdstanr_2023}.
We used the same priors as in \citet{smith_spatially_2023}, which are the default priors in the \texttt{bbsBayes2} R package.
All models were run for four independent chains and were allowed to warm up for 1000 iterations and sample for 2000 iterations per chain.
This resulted in a total of 8000 samples per parameter, per model.
We assessed convergence using the split R-hat statistic \citep{vehtari_rank-normalization_2021}.
All models were run on one of two multi-core processing servers, one running Ubuntu 20.04.4 LTS and one running Ubuntu 20.04.6 LTS.

\par All code is available open-source at https://github.com/BrandonEdwards/bbs-point-level, and will be archived with a DOI upon acceptance of this paper.

\section{Results}

\par Using the ROUTE, POINT, and VARPROP model output, we generated trends and trajectories for Ovenbird in Canada from 2010 - 2022 (Figure \ref{fig:oven-combined}).
The calculated trends among the three models were similar to each other: trend from the ROUTE model was an increase of $0.65\%$ with a 90\% credible interval of $[0.11, 1.24]$; trend from the POINT model was an increase of $1.48\%$ with a 90\% credible interval of $[0.57, 1.73]$; and trend from the VARPROP model was an increase of $0.82\%$ with a 90\% credible interval of $[0.26, 1.39]$.
We note that the y-axis of the three time series in Figure \ref{fig:oven-combined} are rather different from each other: the y-axis for the ROUTE time series is the expected number of observed Ovenbirds on an average route; the y-axis for the POINT time series is the expected number of observed Ovenbirds on an average point; the y-axis for the VARPROP time series is the expected number of observed Ovenbirds on an average 400 m radius point, given perfect detectability.

\par For Ovenbird, the POINT model appeared to be a reasonable proxy for the standard ROUTE model.
On average, indices of abundance from a ROUTE model were approximately 52.3 times the indices from the POINT model, with a 90\% credible interval of $[51.9, 52.7]$ (Figure \ref{fig:route-vs-point}A).
This was slightly greater than our hypothesized value of 50, but note that this could be due to some routes having fewer than 50 points.
Mean values of this slope for individual strata ranged from 44.9 to 64.9.
Trends from each stratum tended to closely match between the ROUTE and POINT model, with an estimated slope of 0.96, with a 90\% credible interval of $[0.93, 0.99]$ (Figure \ref{fig:route-vs-point}B).
This was slightly less than our hypothesized value of 1, indicating that there is not quite a 1-to-1 relationship (but close).

\subsection{Variance Propagation Diagnostics}

\par When comparing indices between DETECT and VARPROP models, we found an overall 1-to-1 correspondence, with an overall modelled slope value of $1.00$ and 90\% credible interval of $[0.88, 1.12]$ (Figure \ref{fig:varprop-diagnostics}A).
This indicated that overall, there was not a large difference in indices obtained from VARPROP model compared to the DETECT model, although these slopes did vary among strata from anywhere between $0.57$ to $1.24$.

\par Removal model variance propagation parameters (i.e., $\zeta$ in Equation \ref{bbs_varprop}) were all effectively zero (Figure \ref{fig:varprop-diagnostics}B), but with varying degrees of uncertainty.
On the other hand, distance model variance propagation parameters (i.e., $\xi$ in Equation \ref{bbs_varprop}) were nonzero for terms that included information about forest coverage, close to zero for the road parameter term, and effectively zero for the intercept term (Figure \ref{fig:varprop-diagnostics}C).

\subsection{Effects of Changing Detectability on Trend}
\par We found a positive relationship (slope = $10.0$ with 90\% credible interval of $[8.75, 11.3]$) between change in forest coverage and the difference between the VARPROP and POINT trend.
Put differently, strata with an average decrease in forest coverage are associated with a negative difference in trend, meaning that for strata with a decrease in forest coverage, the VARPROP model will show a more negative trend than the point model.
As such, strata with an average increase in forest coverage are associated with positive difference in trend, meaning that for strata with an increase in forest coverage, the VARPROP model will show a more positive trend than the point model.

\par This relationship can be seen by focusing in on a route that has experienced a particularly large amount of forest coverage loss over the last decade, such as the one seen in Figure \ref{fig:route-change}A. 
If detectability is not accounted for, such as with the POINT model, we estimate a trend of $-1.50$ (Figure \ref{fig:route-change}B), whereas if detectability is accounted for (due to changes in forest coverage), we estimate a much more negative trend of $-7.92$ (Figure \ref{fig:route-change}C).

\section{Discussion}

\par In this paper, we described how to model BBS data at the point (or stop) level to produce trend estimates using similar model structure to current route-level trend estimates as in \citet{smith_spatially_2023}.
We then expanded upon this point-level trend model by introducing a detectability term that allows for detection probability to explicitly be accounted for in BBS trend estimation.
Because the detection probabilities are estimated based on data in a previous model \citep{edwards_point_2023}, we used a variance propagation technique put forth by \citet{bravington_variance_2021} to explicitly incorporate the detection probability error into the trend model.
Finally, we applied these models in a case study by examining Ovenbird trends in Canada from 2010 - 2022, and assessed how these trends differ by accounting for detectability given changes in landcover over time.
Here, we will mostly discuss the results of the Ovenbird case study and implications of the differences in trends between each of the models.
However, we will suggest future avenues and applications of this extended BBS model, including implications for data integration.

\subsection{Point-level Model as a Reasonable Proxy for Route-level Model}

\par Overall, the point-level trend model served as a reasonable proxy for the status-quo route-level trend model for Ovenbird.
We expected that indices from the route-level model should be approximately 50x the indices from the point-level model within the same stratum, because there are typically 50 points per route.
We found this to be mostly true, although the ratio tended to be slightly greater than 50.
However, this is likely because 50 is the maximum number of points that would be run per route, and any difference from 50 is necessarily fewer points per route, meaning that the ratio may be slightly higher.
When considering trend, we expected an approximate 1-to-1 relationship between the two models, and instead we found a slightly less than 1-to-1 correspondence.
That is to say, trends estimated from a point-level model tend to be slightly higher than trends estimated from a route-level model.
In any case, because our overall goal of this paper was to incorporate detectability into the BBS trend model, our main point of comparison is between trends (and indices) produced by a model that includes detectability versus the status quo model currently used by the BBS.
However, because we cannot directly include detectability into the route model, we needed to have the baseline point-level model as a proxy for the route-level indices and trends.
We felt as though the point level model served as a good proxy in the case of the Ovenbird in Canada, but future studies should seek to include far more species and assess whether these metrics tend to hold for these other species. 

\subsection{Incorporating Detectability Information into BBS Trend Estimates}

\par We created two models that accounted for detectability.
The model in Equation \ref{bbs-detect} only accounts for detectability and treats each estimate of detectability as a fixed, true point, whereas Equation \ref{bbs_varprop} incorporates information about the uncertainty around the estimated detection probabilities for each point.
We were most interested in the model that incorporates detectability as well as uncertainty, but we retained output from the detectability-only model as a basis for the variance propagation diagnostics \citep{bravington_variance_2021}.

\par At the country-level, overall trend and trajectory of Ovenbird did not drastically change, but there was a slight decrease in the magnitude of the trend from the POINT model to the VARPROP model.
That is, the VARPROP model estimated a trend of 0.82, with a 90\% credible interval of [0.26, 1.39], whereas the POINT model estimated a trend of 1.15, with a 90\% credible interval of [0.57, 1.73].
The small change in the trend is not particularly unsurprising given that mean forest coverage change for each point was $-4.78 \times 10^{-3}$: on average, across the sampled Ovenbird points in Canada, forest coverage is not changing significantly.
Thus, the effects of changes in landcover on the effects of detectability, combined with the fact that all of the sampled points are roadside surveys, effectively averages out to no change in trend on this broad scale.

\par Where detectability information appeared to make the most difference in trend estimates was at the finer spatial scale.
Here, we provided an example of a route-level change in trends when adding on detectability information, in that a particular route that had a high level of forest coverage loss (indeed, the most in our analysis) showed a high difference in trends when considering detectability.
In sampling areas with a large loss in forest coverage over time, it would be expected that population loss of forest-dwelling species (such as Ovenbird) would occur with the loss of habitat.
However, when the sampling point was highly forested, say, at the beginning of the time series, the higher number of Ovenbirds may not be as detectable due to the higher forest coverage (and hence lower detectability).
Then, later in the time series, when the sampling point has become more open (but still has some habitat intact), the lower number of Ovenbirds will be more detectable.
An observer may thus detect similar number of Ovenbirds in the open environment than the closed environment, but the number of Ovenbirds detected in the open environment will likely be closer to the true number because they are more highly detectable.
Therefore, by applying detectability information to this seemingly flat trend, the number of unobserved Ovenbirds in the closed environment is accounted for, creating the more negative trend.

\subsection{Assessment of Variance Propagation Diagnostics}

\par \citet{bravington_variance_2021} provides a few ways to assess whether the variance propagation component is, in fact, only propagating the variance forward from the detection equations into the GAM, or whether there are potential confounds with detectability that manifests in the GAM.
In this study, we assessed two of these criteria.

We first compared the indices generated from the VARPROP model to the ``naive" indices generated from the DETECT model, with the prediction that the indices should be close to a one-to-one correspondence.
Overall, we did find a close correspondence between the two sets of indices, which tended to have an increase in variance with larger indices.
This is generally what we would expect with a negative binomial response with a log offset.

We then assessed the posterior estimates of the variance propagation terms $\zeta$ and $\xi$; with no confounds, estimates of these terms should be close to zero, therefore only propagating forward the variance from detectability terms \citep{bravington_variance_2021}.
While the $\zeta$ terms (associated with availability components) were generally estimated around 0, the $\xi$ terms showed quite a bit of differences from zero, particularly with the terms associated with forest coverage.
This implies that there may be a systematic bias or confound between detectability as it pertains to forest coverage, and space \citep{bravington_variance_2021}.
This could possibly be explained by the lack of detail used in vegetation coverage type when considering detectability.
That is to say, while the detectability estimates from NA-POPS only considers forest coverage as a percentage, it does not account for differences in forest type (e.g., coniferous vs deciduous vs mixed).
Additionally, in more open habitats, there is no differentiation between, for example, forest that gets converted to grassland versus forest that gets converted to urban land.
Previous studies have shown differences in detectability via sound attentuation based on different habitat types \citep{schieck_biased_1997}, implying that a simple ``open" versus ``closed" may not quite be sufficient in explaining detectability.
Thus, we suggest future iterations of detectability estimates from NA-POPS, and future applications of those detectability estimates to datasets such as the BBS, consider habitat types in addition to the amount of open or closed forest.
It would then be worth investigating whether that eliminates the bias seen in Figure \ref{fig:varprop-diagnostics}.

\subsection{Applications and Implications for Conservation Managers}
\subsubsection{Improve Trend Estimates for Species Listing}

\par North American Breeding Bird Survey data have been used in countless conservation problems \citep{hudson_role_2017}.
It is clear to see why: the dataset is long term, with close to 60 years of longitudinal data; the dataset is highly structured, meaning there are specific protocols that must be followed in order to maintain a sense of homogeneity between counts; and the dataset is comprehensive, given there are routes that span a vast area of Canada and the US.

\par Still, in any survey, the observation process is riddled with biases.
Despite being a highly-structured dataset that has many biases accounted for, observed counts on a BBS route will still suffer from the same observational biases based on surveying at different times of the day, different times of the year, and in different and changing landscapes.
By explicitly incorporating detectability into the BBS analyses, we can correct for some of these additional sources of bias in the dataset in our attempts at trying to model the true underlying abundance of birds.
Similarly, given detectability is currently a dynamic field of research, particularly in the bird world but among other taxa as well, future BBS output that include the most up-to-date research on detectability can begin to generate trends that more closely reflect the true increases or decreases of bird species.
This is particularly important in jurisdictions such as Canada that rely on estimates from the BBS to inform the listing and delisting process of species at risk.
Species where the true trend is masked by changes in detectability may not be able to get properly listed, and thus could face continuing threats and issues that come with ``monitoring to extinction" \citep{martin_acting_2012, lindenmayer_counting_2013}.
By being able to include this key piece of information, and by being able to account for a large source of bias, the BBS can continue to provide excellent information on status, trends, and relative abundance of birds in North America well into the future.

\subsubsection{Data Integration}

\par Data integration is an increasingly growing topic throughout ecology \citep{isaac_data_2020, miller_recent_2019, pacifici_integrating_2017, boersch-supan_integrating_2021}, especially as the number of data sets continue to grow \citep{binley_minimizing_2023}.
As such, recognizing what biases exist---in both professionally-collected data and community science data \citep{binley_data_2023}---across complementary data sets and working out methodologies to jointly model these data sets can improve inference of the state of a biological system.

\par While the BBS samples a vast area of Canada and the US, there are still significant gaps in coverage, such as offroad areas, and the boreal forest. 
However, programs such as Integrating Monitoring in Bird Conservation Regions \citep{pavlacky_statistically_2017}, Boreal Avian Modelling project \citep{cumming_toward_2010}, and eBird \citep{sullivan_ebird_2014} can help fill in these gaps.
The point-level model in this study combined with the NA-POPS estimates provide a potentially simple way of integrating these data within the current BBS status and trend models, because the NA-POPS detectability estimates correct for biases in survey duration, survey radius, environmental conditions, and temporal conditions.
As such, once QPAD \citep{solymos_calibrating_2013} estimates are applied to a point count, including points from the BBS, it is effectively ``speaking the same language" as other point count data sets with QPAD offsets applied.
In this way, the data can be jointly considered under the same modelling framework.
We propose that future studies investigate how to directly include data from Boreal Avian Modelling project, Integrated Monitoring in Bird Conservation Regions, eBird, and other data sets across the continent, into the BBS modelling framework.
We suspect that such a model would have a similar model structure as Equation \ref{bbs_varprop}, but perhaps with extra terms for project-specific effects.
Because counts within a stratum are averaged for trend, even if additional data is sparse in a specific stratum, it will still contribute to the trend.


\subsection{Call to Action: The Need for BBS Point Locations}

\par This study provides two key steps forward in modelling North American BBS data: 1) we show how to model BBS data at an even finer spatial scale (i.e., at the point/stop level) than previous models, and 2) we provide a way forward to explicitly incorporate detectability into analyses of BBS data.
Incorporating detectability into BBS analyses has been a widely-discussed topic in the literature for decades \citep{sauer_observer_1994, ankorikarlinsky_north_2022, zhang_habitat_2021, somershoe_combining_2006, griffith_traffic_2010, binley_better_2023, knight_combination_2021}.
Several reasons exist as to why this has not been previously accounted for: 1) the BBS sampling does not allow for removal or distance sampling, 2) explicit detectability estimates did not previously exist for the suite of species modelled by BAM and NA-POPS, and 3) the BBS has been analyzed at the route level, whereas the observation processes (including detectability) happen at the point level.
However, we are finally close to a point where we have all the information needed, as shown here.
The QPAD method \citep{solymos_calibrating_2013} has allowed for broad-scale estimates of detectability in landbirds, which has resulted in detectability estimates for over 300 species in the NA-POPS database \citep{edwards_point_2023}.
These detectability offsets can be applied to any point count, including ones like the BBS that do not include removal or distance sampling.
This means that as long as we have access to point-level counts for the BBS (such as through bbsBayes \citep{edwards_bbsbayes_2021}, bbsAssistant \citep{burnett_bbsassistant_2019}, or straight through the USGS website), we can apply detectability estimates as offsets in the model, and correct for detectability.

\par A major caveat to the above is that in order to apply detectability offsets that include information about habitat, it is necessary to know where the BBS points are.
By knowing the coordinates of the point-count centre, one can extract information about the habitat around a 400 m buffer (i.e., the point count area), using GIS tools and landcover layers. 
However, BBS point locations generally seem to be a difficult dataset to come by, thereby limiting this ability to explictly include landcover information into detectability corrections.
Of course, there are properties of the BBS that can easily be inferred based on the data that are available, including start time of point counts, day of the year the route (and therefore points) were run, the fact that all the points are a roadside survey, and the fact that all the points are three minutes in duration and have a maximum survey radius of 400 m.
If, for example, a species had a Roadside-only model chosen as the best explanatory model for perceptibility in NA-POPS, then a researcher may not need information about exact locations of BBS points.
However, we have clearly shown here how species trends can be drastically affected by changes in detectability, due to changes in forest coverage in the landscape.
Thus, we implore agencies who manage the BBS to consider data management and data releases that include all information at the point level, including point locations and changes to point locations over the year.
Only then can we truly have a mechanistic and holistic understanding of the interactions between the landscape, detectability, and the number of species that BBS observers are observing.

\section{Appendix A Expanding on the Derivation of the BBS Model with Variance Propagation}

\par As discussed in Section \ref{varprop-text}, we can expand the BBS model from Equation \ref{bbs-detect} to propagate forward the variance from detectability estimates, by adding in the variance propagation terms $	\log(pq) = log(\hat{p} \hat{q}) + \kappa^{(p)}\zeta + O(\zeta^2) + \kappa^{(q)}\xi + O(\xi^2)$.
Here, we provide detailed derivations of this term.
We note that these are nearly the exact same derivations as outlined in \citet{bravington_variance_2021}, but we include them here for the sake of completeness.

\par First, we start with $\log(pq) = \log(p) + \log(q)$.
We will only work on the $\log(p)$ term here to start. 
If we rewrite $\log(p) = \log(\hat{p}) + \log(p) - \log(\hat{p})$, we can then perform a Taylor expansion of $\log(\hat{p}) = \log p(\hat{\theta})$ about $\theta_0$, the true and unknown value of $\theta$:

$$\log p(\hat{\theta}) = \log p(\theta_0) + \left( \hat{\theta} - \theta_0 \right)^T \dot \\ \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right] + O(\hat{\theta} - \theta_0)^2. $$

If we substitute the above into $\log(p) = \log(\hat{p}) + \log(p) - \log(\hat{p})$, we get:

$$	\log(p)  = \log(\hat{p}) + \log(p) - \log(\hat{p}) $$
$$ = \log p(\theta_0) + \left( \hat{\theta} - \theta_0 \right)^T \dot \\ \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right] + O(\hat{\theta} - \theta_0)^2 + \log(p) - $$
$$ \left[ \log p(\theta_0) + \left( \hat{\theta} - \theta_0 \right)^T \dot \\ \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right] + O(\hat{\theta} - \theta_0)^2  \right] $$

$$ = \log p(\theta_0) + \left( \hat{\theta} - \theta_0 \right)^T \dot \\ \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right] + O(\hat{\theta} - \theta_0)^2 + $$
$$\log p(\hat{\theta}) - \left( \hat{\theta} - \theta_0 \right)^T \dot \\ \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right] - O(\hat{\theta} - \theta_0)^2 $$
$$ - \log p(\theta_0) - \left( \hat{\theta} - \theta_0 \right)^T \dot \\ \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right] - O(\hat{\theta} - \theta_0)^2  $$

$$ = \log p(\hat{\theta}) - \left( \hat{\theta} - \theta_0 \right)^T \dot \\ \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right] - O(\hat{\theta} - \theta_0)^2. $$

As in \citet{bravington_variance_2021}, we will define $\zeta = \hat{\theta} - \theta_0$ and $\kappa^{(p)} = \left[ \dfrac{\partial \log p({\theta_0})}{\partial {\theta_0}}  \right]$ so that the above becomes

$$\log(p) = \log p(\hat{\theta}) + \zeta\kappa^{(p)} + O(\hat{\theta} - \theta_0)^2.$$

We can now see that we have introduced the estimated availability (i.e., $\log p(\hat{\theta})$) and as a result of the Taylor expansion we have introduced the variance propagation term $\zeta\kappa^{(p)}$.

\par It follows that if we now perform the same expansions to $\log(q)$, we would get that $\log(q) = \log q(\hat{\theta}) + \xi\kappa^{(q)} + O(\hat{\theta} - \theta_0)^2$ with $\xi$ and $\kappa^{(q)}$ similarly defined.

\par The parameters $\zeta$ and $\xi$ are basis coefficients for the variance propagation for $\hat{p}$ and $\hat{q}$, respectively, and play a similar role to that played by the basis coefficients in the GAM model \citep{bravington_variance_2021}. 
In a Bayesian context, we have that $\zeta \sim N(\boldsymbol{0}, \boldsymbol{V_p})$, where $V_p$ is the covariance matrix for $\hat{p}$, and $\xi \sim N(\boldsymbol{V_q})$, where $V_q$ is the covariance matrix for $\hat{q}$.

\par The design matrices for $\zeta$ and $\xi$, denoted here as $\kappa^{(p)}$ and $\kappa^{(q)}$, are both vectors that are obtained by taking the first partial derivatives of the log probabilities $p$ and $q$ and evaluating these at $\theta = \hat{\theta}$, i.e. at its maximum likelihood estimation. 
From \citet{solymos_calibrating_2013}, we have that availability $p(\theta) = 1 - \exp\left\{-t\phi\right\}$, where $\phi = \exp\left(\theta\right)$ represents the cue rate for a given species, regressed against various factors that affect cue rate (such as ordinal day, time since sunrise, or their quadratic terms). 
If we have a vector {\boldmath$\beta$} of $S$ parameters and a design matrix $X$, we can set $\theta = X\boldsymbol{\beta}$, and find that the first partial derivative with respect to $\beta_s$, $s \in \left[0, S\right]$, and hence the $s$th entry of the design matrix $\kappa^{(p)}$, is given by
\begin{equation*}\label{kappa_p}
	\kappa_{s}^{(p)} = \left.\dfrac{\partial \log p(\theta)}{\partial \beta_s}\right\vert_{\theta = \hat{\theta}} = \left. X_s \times \dfrac{t \exp\left\{X\boldsymbol{\beta}\right\}}{\exp\left\{t \exp\left\{X\boldsymbol{\beta}\right\}\right\} - 1} \right\vert_{\beta = \hat{\beta}}
\end{equation*}

\par If we now consider perceptibility, from \citet{solymos_calibrating_2013}, we have that perceptibility $q(\theta) = \dfrac{\pi \tau^2 \left\{1 - \exp\left(\dfrac{-r^2}{\tau^2}\right)\right\}}{\pi r^2}$, where $\tau = \exp(\theta)$ represents the effective detection radius for a given species, regressed against various factors that could effect effective detection radius (such as survey roadside status and forest coverage). 
If we have a vector {\boldmath$\beta$} of $S$ parameters and a design matrix $X$, we can set $\theta = X\boldsymbol{\beta}$, and find that the first partial derivative with respect to $\beta_s$, $s \in \left[0, S\right]$, and hence the $s$th entry of the design matrix $\kappa^{(q)}$, is given by

\begin{equation*}\label{kappa_q}
	\kappa_{s}^{(q)} = \left. \dfrac{\partial \log q(\theta)}{\partial \beta_s} \right\vert_{\theta = \hat{\theta}}= \left. X_s \left[\dfrac{{e^{-2X\boldsymbol{\beta}}} {2 \pi  e^{2X\boldsymbol{\beta}}} {\left(1 - e^{r^2 \left(-e^{-2X\boldsymbol{\beta}}\right)}\right)} - {2\pi r^2} {e^{r^2 \left(-e^{-2X\boldsymbol{\beta}}\right)}}}             {\pi {1-e^{r^2 \left(-e^{-2X\boldsymbol{\beta}}\right)}}}\right]  - log(\pi^2r^2) \right\vert_{\beta = \hat{\beta}}
\end{equation*}

\par Finally, the terms $O(\zeta^2)$ and $O(\xi^2)$ arise from the Taylor approximations that are used to arrive at Equation \ref{offset} \citep{bravington_variance_2021}. 
Since we only use the Taylor approximations up to the 2nd term of the Taylor series, our offset term is asymptotically accurate to $O(\zeta^2) + O(\xi^2) = O(\zeta^2 + \xi^2)$.
However, for the purposes of modelling in a Bayesian context, we can ignore these terms.

Putting everything together, we arrive at the following point-level model that includes the log offset term and variance propagation terms:
\begin{equation*}
	\log(\lambda_{j,i,t}) = \log(\hat{p} \hat{q})_{j,i,t} + \kappa_{j,i,t}^{(p)}\zeta + \kappa_{j,i,t}^{(q)}\xi + \alpha_i + \delta_{i,t} + \gamma_{i,t} + \psi_j + \omega_o + \eta I(o,j,t) + \epsilon_{j,i,t,o} \\
\end{equation*}

as in Equation \ref{bbs_varprop}.

\section{Figures}

\begin{figure}[h]
	\includegraphics{../ch5-bbs-detectability/output/plots/OVEN-combined.png}
	\caption{Canada-wide trends and trajectories for Ovenbird as derived from the status-quo route model in Equation \ref{bbs} and \citet{smith_spatially_2023} (top row), the point-level model as in Equation \ref{bbs-point} (middle row), and the point-level model that includes detectability and variance propagation as in Equation \ref{bbs_varprop} (bottom row). Note we have not included the DETECT model from Equation \ref{bbs-detect} as it was used mainly for comparison to the VARPROP model. Be aware of the differences in the y-axes for each of these models: the ROUTE y-axis is the annual index of abundance per route, the POINT y-axis is the annual index of abundance per point, and the VARPROP y-axis is the expended annual index of abundance per point given perfect detectability.}
	\label{fig:oven-combined}
\end{figure}

\begin{figure}[h]
	\includegraphics{../ch5-bbs-detectability/output/plots/route-vs-point.png}
	\caption{Index of abundance (A) and trend (B) derived from POINT model versus ROUTE model. Each point in A represents an index of abundance for a stratum x year combination, whereas each point in B represents a trend estimate for a stratum. Regression lines (black) and posterior draws (grey) indicate modelled relationship.}
	\label{fig:route-vs-point}
\end{figure}

\begin{figure}[h]
	\includegraphics{../ch5-bbs-detectability/output/plots/varprop-diagnostics.png}
	\caption{Diagnostics of variance propagation as suggested by \citet{bravington_variance_2021}. A) Index of abundance as derived from the DETECT model versus index of abundance as derived from the VARPROP model, for each stratum x year combination (points). Regression line (black) and posterior draws (grey) indicate modelled relationship. B) Variance propagation parameter posterior distributions for availability. Because we are using the ``best" NA-POPS removal model for Ovenbird, we only have parameter distributions for the Intercept, Ordinal Day, and Ordinal Day squared terms. C) Variance propagation parameter posterior distributions for perceptibility. Similar to B), because we are using the ``best" NA-POPS distance model for Ovenbird, we include distributions for the Intercept, Forest, Road, and interaction terms.}
	\label{fig:varprop-diagnostics}
\end{figure}

\begin{figure}[h]
	\includegraphics{../ch5-bbs-detectability/output/plots/trend-vs-forest.png}
	\caption{Change in forest coverage versus difference in trend between the VARPROP and POINT models. Change in forest coverage was calculated as the difference between forest coverage in 2022 and 2010. Trend difference was calculated as the VARPROP trend minus the POINT trend. Regression line (black) and posterior draws (grey) indicate the modelled relationship.}
	\label{fig:trend-vs-forest}
\end{figure}

\begin{figure}[h]
	\includegraphics{../ch5-bbs-detectability/output/plots/route-level-change.png}
	\caption{A) Map of forest coverage change from 2010 - 2022 at all Breeding Bird Survey points in Canada for Ovenbird. Inset is a particular route of interest in Ontario that has experienced significant forest coverage loss from 2010 - 2022. For this route, we compared the population trajectories of Ovenbird using the POINT model (B) to the population trajectories of Ovenbird using the VARPROP model (C) to assess differences in trend.}
	\label{fig:route-change}
\end{figure}
